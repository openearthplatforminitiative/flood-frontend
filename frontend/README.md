# flood-frontend

This is a [Next.js](https://nextjs.org/) project bootstrapped with [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app).

## Getting Started

When running locally the application expects a `.env.local` file in the root of the `frontend` folder. The file should contain the following variables:

- `KEYCLOAK_ID` - The client ID of the Keycloak client. Unless the `keycloak/keycloak.ts` is self configured, the default value is `web`.
- `KEYCLOAK_SECRET` - The client secret of the Keycloak client. This secret can be found in the Keycloak admin interface, or in SSM parameter store in the AWS console.
- `KEYCLOAK_ISSUER` - The issuer URL of the Keycloak server. If the realm is called "flood-frontend" and the Keycloak server is using the domain `auth.flood.openepi.io`, the issuer URL would typically be `https://auth.flood.openepi.io/auth/realms/flood-frontend`. During development one should preferably either use a Keycloak server running in a development environment or a local Keycloak server.
- `NEXTAUTH_URL` - The URL of the Next.js application. If local, set this to `http://localhost:3000`
- `NEXTAUTH_SECRET` - A secret used by NextAuth. During development this can be any string. During production this is automatically generated by Pulumi
- `DATABASE_URL` - The connection string to the database that Prisma should use. Example: `"postgresql://username:password@localhost:5432/flood_frontend"`

### Configure local database
Uses Prisma for database access.
To configure the database for local development, you can for example use docker

```bash
docker run --name flood-frontend -e POSTGRES_PASSWORD=mysecretpassword -p 5432:5432 -d postgres
```

Then to migrate the database, use
```bash
DATABASE_URL="postgresql://postgres:mysecretpassword@localhost:5432/flood_frontend" npx prisma migrate deploy
```

### Run the application

First, build the development server:
```bash
npm install
```

Then, run the development server:

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/[lang]/page.tsx`. The page auto-updates as you edit the file.
